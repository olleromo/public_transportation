!function t(e,o,n){function a(i,c){if(!o[i]){if(!e[i]){var s="function"==typeof require&&require;if(!c&&s)return s(i,!0);if(r)return r(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=o[i]={exports:{}};e[i][0].call(u.exports,function(t){var o=e[i][1][t];return a(o?o:t)},u,u.exports,t,e,o,n)}return o[i].exports}for(var r="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(t,e,o){!function(t,n){"undefined"!=typeof o?"undefined"!=typeof e&&e.exports&&(o=e.exports=n(t,o)):"function"==typeof define&&define.amd?define(["exports"],function(e){t.Lockr=n(t,e)}):t.Lockr=n(t,{})}(this,function(t,e){"use strict";return Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,o=Number(arguments[1])||0;for(o=0>o?Math.ceil(o):Math.floor(o),0>o&&(o+=e);e>o;o++)if(o in this&&this[o]===t)return o;return-1}),e.prefix="",e._getPrefixedKey=function(t,e){return e=e||{},e.noPrefix?t:this.prefix+t},e.set=function(t,e,o){var n=this._getPrefixedKey(t,o);try{localStorage.setItem(n,JSON.stringify({data:e}))}catch(a){console&&console.warn("Lockr didn't successfully save the '{"+t+": "+e+"}' pair, because the localStorage is full.")}},e.get=function(t,e,o){var n,a=this._getPrefixedKey(t,o);try{n=JSON.parse(localStorage.getItem(a))}catch(r){try{n=localStorage[a]?JSON.parse('{"data":"'+localStorage.getItem(a)+'"}'):null}catch(r){console&&console.warn("Lockr could not load the item with key "+t)}}return null===n?e:"undefined"!=typeof n.data?n.data:e},e.sadd=function(t,o,n){var a,r=this._getPrefixedKey(t,n),i=e.smembers(t);if(i.indexOf(o)>-1)return null;try{i.push(o),a=JSON.stringify({data:i}),localStorage.setItem(r,a)}catch(c){console.log(c),console&&console.warn("Lockr didn't successfully add the "+o+" to "+t+" set, because the localStorage is full.")}},e.smembers=function(t,e){var o,n=this._getPrefixedKey(t,e);try{o=JSON.parse(localStorage.getItem(n))}catch(a){o=null}return null===o?[]:o.data||[]},e.sismember=function(t,o,n){this._getPrefixedKey(t,n);return e.smembers(t).indexOf(o)>-1},e.getAll=function(){var t=Object.keys(localStorage);return t.map(function(t){return e.get(t)})},e.srem=function(t,o,n){var a,r,i=this._getPrefixedKey(t,n),c=e.smembers(t,o);r=c.indexOf(o),r>-1&&c.splice(r,1),a=JSON.stringify({data:c});try{localStorage.setItem(i,a)}catch(s){console&&console.warn("Lockr couldn't remove the "+o+" from the set "+t)}},e.rm=function(t){localStorage.removeItem(t)},e.flush=function(){localStorage.clear()},e})},{}],2:[function(t,e,o){!function(e){lockr=t("/Users/or/UDACITY/public_transportation/node_modules/lockr/lockr.js"),javascript_search=t("/Users/or/UDACITY/public_transportation/src/js/query.js"),console.log("app.js loaded");var o=e("#loadingDiv").hide();e(document).ajaxStart(function(){o.show()}).ajaxStop(function(){o.hide()})}(jQuery)},{"/Users/or/UDACITY/public_transportation/node_modules/lockr/lockr.js":1,"/Users/or/UDACITY/public_transportation/src/js/query.js":3}],3:[function(t,e,o){function n(){var t="<REQUEST><LOGIN authenticationkey='668a9ad34dfb4736880a8ce55c9a5f38' /><QUERY objecttype='TrainStation'><FILTER/><INCLUDE>Prognosticated</INCLUDE><INCLUDE>AdvertisedLocationName</INCLUDE><INCLUDE>LocationSignature</INCLUDE></QUERY></REQUEST>",e=[];void 0==localStorage.getItem("stationlist")&&(console.log("doing ajax"),$.ajax({type:"POST",contentType:"text/xml",dataType:"json",data:t,success:function(t){if(null!=t)try{$(t.RESPONSE.RESULT[0].TrainStation).each(function(t,o){d.push({label:o.LocationSignature,value:o.AdvertisedLocationName}),1==o.Prognosticated&&e.push({label:o.AdvertisedLocationName,value:o.LocationSignature})}),lockr.set("stationlist",e),lockr.set("stations",d)}catch(o){console.log("something bad happened: "+o)}}})),a(lockr.get("stationlist"))}function a(t){$("#station-from").val(""),$("#station-to").val(""),$("#station-from").autocomplete({source:function(e,o){var n=$.map(t,function(t){return 0===t.label.toUpperCase().indexOf(e.term.toUpperCase())?{label:t.label,value:t.value}:void 0});o(n)},select:function(t,e){var o=e.item;return $("#station-from").val(o.label),$("#station-from").data("sign",o.value),!1},focus:function(t,e){var o=e.item;return $("#station-from").val(o.label),!1},create:function(t){$(this).prev(".ui-helper-hidden-accessible").remove()}}),$("#station-to").autocomplete({source:function(e,o){var n=$.map(t,function(t){return 0===t.label.toUpperCase().indexOf(e.term.toUpperCase())?{label:t.label,value:t.value}:void 0});o(n)},select:function(t,e){var o=e.item;return $("#station-to").val(o.label),$("#station-to").data("sign",o.value),!1},focus:function(t,e){var o=e.item;return $("#station-to").val(o.label),!1},create:function(t){$(this).prev(".ui-helper-hidden-accessible").remove()}})}function r(t){var e="<REQUEST version='1.0'><LOGIN authenticationkey='668a9ad34dfb4736880a8ce55c9a5f38' /><QUERY objecttype='TrainAnnouncement' orderby='AdvertisedTimeAtLocation' ><FILTER><AND><OR><AND><GT name='AdvertisedTimeAtLocation' value='$dateadd(-00:15:00)' /><LT name='AdvertisedTimeAtLocation' value='$dateadd(24:00:00)' /></AND><GT name='EstimatedTimeAtLocation' value='$now' /></OR><EQ name='LocationSignature' value='"+t+"' /><EQ name='ActivityType' value='Avgang' /></AND></FILTER><INCLUDE>InformationOwner</INCLUDE><INCLUDE>AdvertisedTimeAtLocation</INCLUDE><INCLUDE>TrackAtLocation</INCLUDE><INCLUDE>FromLocation</INCLUDE><INCLUDE>ToLocation</INCLUDE></QUERY></REQUEST>",o=new Promise(function(t,o){$.ajax({type:"POST",contentType:"text/xml",dataType:"json",data:e,success:function(e){null==e&&o("no network"),null==e.RESPONSE.RESULT[0].TrainAnnouncement&&o("no departures found");try{console.log("about to resolve"),t(e.RESPONSE.RESULT[0].TrainAnnouncement)}catch(n){console.log("something went wrong with saving the response: "+n),o(n)}}})});return o}function i(t,e,o){var n=(lockr.get(t),new Date),a=36e5*o,i=0;lockr.get(t)&&(i=new Date(lockr.get(t).date).getTime()+864e5),i-(n.getTime()+a)<0?r(t).then(function(n){c(t,n),console.log("rendering from network"),u("Data from network"),l(s(n,e,o))})["catch"](function(e){lockr.set(t,""),console.log("err: "+e),f("Something bad happened")}):(console.log("rendering from store"),u("Data from local storage"),l(s(lockr.get(t).result,e,o)))}function c(t,e){lockr.set(t,{result:e,date:new Date}),console.log("saveResponse: "+t)}function s(t,e,o){var n=new Array,a=(new Date).getTime(),r=36e5*o;return $(t).each(function(t,o){var i=new Date(o.AdvertisedTimeAtLocation).getTime();i>a&&a+r>i&&$(o.ToLocation).each(function(t,a){a==e&&n.push(o)})}),n}function l(t){var e=lockr.get("stations");console.log("announcement.length: "+t.length),f(0===t.length?"No results found":""),$(t).each(function(t,o){var n=new Date(o.AdvertisedTimeAtLocation),a=n.getHours(),r=n.getMinutes();10>r&&(r="0"+r);var i=new Array;$(o.ToLocation).each(function(t,o){for(var n=0;n<e.length;n++)o===e[n].label&&i.push(e[n].value)});var c="";null!=o.InformationOwner&&(c=o.InformationOwner),jQuery("#timeTableDeparture tr:last").after("<tr><td>"+a+":"+r+"</td><td>"+i.join(", ")+"</td><td>"+c+"</td><td style='text-align: center'>"+o.TrackAtLocation+"</td></tr>")})}function u(t){$("#messagedisplay").text(t)}function f(t){$("#messagedisplay2").text(t)}var d=[];$(document).ready(function(){$.support.cors=!0;try{$.ajaxSetup({url:"http://api.trafikinfo.trafikverket.se/v1/data.json",error:function(t){"abort"!=t.statusText&&u("No network connection")}})}catch(t){u("An error ocurred while initializing.")}var e;$("#loader").hide(),$(document).ajaxStart(function(){e=setTimeout(function(){$("#loader").show()},200)}).ajaxStop(function(){clearTimeout(e),$("#loader").hide()}),n(),$("#station-from").focus(function(){$(this).val("")}),$("#station-to").focus(function(){$(this).val("")}),$("#interval").focus(function(){$(this).val("")})}),window.Search=function(){var t=$("#station-from").data("sign"),e=$("#station-to").data("sign"),o=$("#interval").val().toString();$("#timeTableDeparture tr:not(:first)").remove(),i(t,e,o)}},{}]},{},[2]);